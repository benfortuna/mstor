plugins {
    id "org.sonarqube" version "1.2"
}

apply plugin: 'eclipse'
apply plugin: 'groovy'
apply plugin: 'checkstyle'
apply plugin: 'findbugs'
apply plugin: 'pmd'
//apply plugin: 'codenarc'
apply plugin: 'osgi'

[checkstyle, findbugs, pmd]*.ignoreFailures = true
checkstyle.configProperties = ['checkstyle.suppressions.file': "${project.projectDir}/config/checkstyle/default-suppressions.xml"]

repositories {
    mavenCentral()
    maven {
        url "https://oss.sonatype.org/content/repositories/snapshots/"
    }
}

ext {
    groovyVersion = '2.1.7'
    slf4jVersion = '1.7.5'
    jackrabbitVersion = '2.7.1'
    spockVersion = '0.7-groovy-2.0'
    logbackVersion = '1.0.6'
    junitVersion = '4.11'
}

dependencies {
    compile 'commons-lang:commons-lang:2.6'
    compile 'commons-net:commons-net:3.0.1'
    compile 'jdom:jdom:1.0'
    compile 'com.thoughtworks.xstream:xstream:1.4.2'
    compile 'javax.mail:mail:1.4'
    compile 'org.jyaml:jyaml:1.3'
    compile 'javax.jcr:jcr:2.0'
    compile 'org.jcrom:jcrom:2.0.0'
    compile 'net.sf.ehcache:ehcache-core:2.5.0'
    compile 'commons-io:commons-io:2.1'
    compile "org.codehaus.groovy:groovy-all:$groovyVersion"
    compile 'cglib:cglib:2.2.2'
    compile "org.slf4j:slf4j-api:$slf4jVersion"
    compile "org.slf4j:jul-to-slf4j:$slf4jVersion"
    compile "org.slf4j:jcl-over-slf4j:$slf4jVersion"
    compile "org.apache.jackrabbit:jackrabbit-jcr-rmi:$jackrabbitVersion"
    // used in javadoc generation..
    compile 'biz.aQute.bnd:bndlib:2.2.0'

    runtime 'commons-logging:commons-logging:1.1.1'

    testCompile "org.apache.jackrabbit:jackrabbit-core:$jackrabbitVersion"
    testCompile "junit:junit:$junitVersion"
    testCompile "org.spockframework:spock-core:$spockVersion"
    testCompile "ch.qos.logback:logback-classic:$logbackVersion"
    testCompile 'org.mnode.juicer:juicer:0.9.2-SNAPSHOT'
}

test {
    include '**/*Test.class'
    include '**/*Spec.class'

    exclude '**/AbstractMStorTest.class'
    exclude '**/MessedUpCacheTest.class'
    exclude '**/MStorStoreTest.class'
    exclude '**/MStorFolderTest.class'
    exclude '**/MStorMessageTest.class'
    exclude '**/UIDFolderTest.class'
    exclude '**/TagsTermTest.class'
    exclude '**/TagTest.class'
    exclude '**/*IntegrationTest.class'
}

task integrationTest(type: Test, dependsOn: 'test') << {
    include '**/*IntegrationTest.class'
}
